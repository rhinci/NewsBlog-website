{% extends "base.html" %}
{% block body %}
<h1>{{ article.title }}</h1>
<p>Автор: {{ article.user }}</p>
<div>
  {{ article.text }}
</div>
<p>Опубликовано: {{ article.created_date|date:"d.m.Y H:i" }}</p>

{% if user.is_authenticated and user == article.user %}
    <div class="article-actions">
        <a href="{% url 'edit_article' article.id %}" class="btn-edit">Редактировать</a>

        <form method="post" action="{% url 'delete_article' article.id %}" style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="btn-delete" 
                onclick="return confirm('Вы уверены, что хотите удалить эту статью?')">
            Удалить
        </button>
    </form>
    </div>
    
{% endif %}


<div class="comments-section">
    <h3>Комментарии ({{ comments.count }})</h3>

    <div class="comment-form">
        <h4>Добавить комментарий</h4>
        <form method="post">
            {% csrf_token %}
            
            <div class="form-group">
                {{ form.author_name }}
                {% if form.author_name.errors %}
                    <div class="error">{{ form.author_name.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-group">
                {{ form.text }}
                {% if form.text.errors %}
                    <div class="error">{{ form.text.errors }}</div>
                {% endif %}
            </div>
            
            <button type="submit" class="btn">Отправить комментарий</button>
        </form>
    </div>

    <div class="comments-list">
        {% for comment in comments %}
        <div class="comment">
            <div class="comment-header">
                <strong>{{ comment.author_name }}</strong>
                <span class="comment-date">{{ comment.date|date:"d.m.Y H:i" }}</span>
            </div>
            <div class="comment-text">
                {{ comment.text|linebreaks }}
            </div>
        </div>
        {% empty %}
        <p>К этой статье пока нет комментариев.</p>
        {% endfor %}
    </div>
</div>


{% endblock body %}
